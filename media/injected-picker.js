(()=>{"use strict";const e="p".charCodeAt(0),t="H".charCodeAt(0),n="Y".charCodeAt(0),o="s".charCodeAt(0);let r;function a(a,i,s=!1){const l=new Uint8Array(13);i*=39.3701,l[0]=e,l[1]=t,l[2]=n,l[3]=o,l[4]=i>>>24,l[5]=i>>>16,l[6]=i>>>8,l[7]=255&i,l[8]=l[4],l[9]=l[5],l[10]=l[6],l[11]=l[7],l[12]=1;const c=function(e){let t=-1;r||(r=function(){const e=new Int32Array(256);for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}());for(let n=0;n<e.length;n++)t=r[255&(t^e[n])]^t>>>8;return-1^t}(l),d=new Uint8Array(4);if(d[0]=c>>>24,d[1]=c>>>16,d[2]=c>>>8,d[3]=255&c,s){const r=function(r){for(let a=r.length-1;a>=4;a--)if(9===r[a-4]&&r[a-3]===e&&r[a-2]===t&&r[a-1]===n&&r[a]===o)return a-3;return 0}(a);return a.set(l,r),a.set(d,r+13),a}{const e=new Uint8Array(4);e[0]=0,e[1]=0,e[2]=0,e[3]=9;const t=new Uint8Array(54);return t.set(a,0),t.set(e,33),t.set(l,37),t.set(d,50),t}}const i="[modern-screenshot]",s="undefined"!=typeof window,l=s&&"Worker"in window,c=s&&"atob"in window,d=s&&"btoa"in window,u=s?window.navigator?.userAgent:"",g=u.includes("Chrome"),f=u.includes("AppleWebKit")&&!g,m=u.includes("Firefox"),h=e=>1===e.nodeType,p=e=>"object"==typeof e.className,w=e=>"image"===e.tagName,y=e=>h(e)&&void 0!==e.style&&!p(e),b=e=>8===e.nodeType,v=e=>"IMG"===e.tagName,x=e=>"VIDEO"===e.tagName,S=e=>"SLOT"===e.tagName;function E(e){const t=e?.createElement?.("canvas");return t&&(t.height=t.width=1),Boolean(t)&&"toDataURL"in t&&Boolean(t.toDataURL("image/webp").includes("image/webp"))}const C=e=>e.startsWith("data:");function A(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(s&&e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;if(!s)return e;const n=N().implementation.createHTMLDocument(),o=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(r),t&&(o.href=t),r.href=e,r.href}function N(e){return(e&&h(e)?e?.ownerDocument:e)??window.document}const $="http://www.w3.org/2000/svg";const k=e=>function(e,t){return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>n(r.result),r.onerror=()=>o(r.error),r.onabort=()=>o(new Error(`Failed read blob to ${t}`)),"dataUrl"===t?r.readAsDataURL(e):"arrayBuffer"===t&&r.readAsArrayBuffer(e)})}(e,"dataUrl");function D(e,t){const n=N(t).createElement("img");return n.decoding="sync",n.loading="eager",n.src=e,n}function T(e,t){return new Promise(n=>{const{timeout:o,ownerDocument:r,onError:a,onWarn:i}=t??{},s="string"==typeof e?D(e,N(r)):e;let l=null,c=null;function d(){n(s),l&&clearTimeout(l),c?.()}if(o&&(l=setTimeout(d,o)),x(s)){const e=s.currentSrc||s.src;if(!e)return s.poster?T(s.poster,t).then(n):d();if(s.readyState>=2)return d();const o=d,r=t=>{i?.("Failed video load",e,t),a?.(t),d()};c=()=>{s.removeEventListener("loadeddata",o),s.removeEventListener("error",r)},s.addEventListener("loadeddata",o,{once:!0}),s.addEventListener("error",r,{once:!0})}else{const e=w(s)?s.href.baseVal:s.currentSrc||s.src;if(!e)return d();const t=async()=>{if(v(s)&&"decode"in s)try{await s.decode()}catch(t){i?.("Failed to decode image, trying to render anyway",s.dataset.originalSrc||e,t)}d()},n=t=>{i?.("Failed image load",s.dataset.originalSrc||e,t),d()};if(v(s)&&s.complete)return t();c=()=>{s.removeEventListener("load",t),s.removeEventListener("error",n)},s.addEventListener("load",t,{once:!0}),s.addEventListener("error",n,{once:!0})}})}const F=function(){let e=0;return()=>(e+=1,`u${`0000${(Math.random()*36**4|0).toString(36)}`.slice(-4)}${e}`)}();function P(e){return e?.split(",").map(e=>e.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let I=0;function M(e){const t=`${i}[#${I}]`;return I++,{time:n=>e&&console.time(`${t} ${n}`),timeEnd:n=>e&&console.timeEnd(`${t} ${n}`),warn:(...t)=>e&&((...e)=>console.warn(i,...e))(...t)}}async function L(e,t){return(n=e)&&"__CONTEXT__"in n?e:async function(e,t){const{scale:n=1,workerUrl:o,workerNumber:r=1}=t||{},a=Boolean(t?.debug),i=t?.features??!0,c=e.ownerDocument??(s?window.document:void 0),d=e.ownerDocument?.defaultView??(s?window:void 0),u=new Map,g={width:0,height:0,quality:1,type:"image/png",scale:n,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:a,fetch:{requestInit:(f=t?.fetch?.bypassingCache,{cache:f?"no-cache":"force-cache"}),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...t?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:r,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...t,__CONTEXT__:!0,log:M(a),node:e,ownerDocument:c,ownerWindow:d,dpi:1===n?null:96*n,svgStyleElement:R(c),svgDefsElement:c?.createElementNS($,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:l&&o&&r?r:0})].map(()=>{try{const e=new Worker(o);return e.onmessage=async e=>{const{url:t,result:n}=e.data;n?u.get(t)?.resolve?.(n):u.get(t)?.reject?.(new Error(`Error receiving message from worker: ${t}`))},e.onmessageerror=e=>{const{url:t}=e.data;u.get(t)?.reject?.(new Error(`Error receiving message from worker: ${t}`))},e}catch(e){return g.log.warn("Failed to new Worker",e),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[E(c)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:u,drawImageCount:0,tasks:[],features:i,isEnable:e=>"restoreScrollPosition"===e?"boolean"!=typeof i&&(i[e]??!1):"boolean"==typeof i?i:i[e]??!0,shadowRoots:[]};var f;g.log.time("wait until load"),await async function(e,t){y(e)&&(v(e)||x(e)?await T(e,t):await Promise.all(["img","video"].flatMap(n=>Array.from(e.querySelectorAll(n)).map(e=>T(e,t)))))}(e,{timeout:g.timeout,onWarn:g.log.warn}),g.log.timeEnd("wait until load");const{width:m,height:p}=function(e,t){let{width:n,height:o}=t;if(h(e)&&(!n||!o)){const t=e.getBoundingClientRect();n=n||t.width||Number(e.getAttribute("width"))||0,o=o||t.height||Number(e.getAttribute("height"))||0}return{width:n,height:o}}(e,g);return g.width=m,g.height=p,g}(e,{...t,autoDestruct:!0});var n}function R(e){if(!e)return;const t=e.createElement("style"),n=t.ownerDocument.createTextNode("\n.______background-clip--text {\n  background-clip: text;\n  -webkit-background-clip: text;\n}\n");return t.appendChild(n),t}function _(e,t){if(e.ownerDocument)try{const t=e.toDataURL();if("data:,"!==t)return D(t,e.ownerDocument)}catch(e){t.log.warn("Failed to clone canvas",e)}const n=e.cloneNode(!1),o=e.getContext("2d"),r=n.getContext("2d");try{return o&&r&&r.putImageData(o.getImageData(0,0,e.width,e.height),0,0),n}catch(e){t.log.warn("Failed to clone canvas",e)}return n}const B=["width","height","-webkit-text-fill-color"],j=["stroke","fill"];function U(e,t,n){const{defaultComputedStyles:o}=n,r=e.nodeName.toLowerCase(),a=p(e)&&"svg"!==r,i=a?j.map(t=>[t,e.getAttribute(t)]).filter(([,e])=>null!==e):[],s=[a&&"svg",r,i.map((e,t)=>`${e}=${t}`).join(","),t].filter(Boolean).join(":");if(o.has(s))return o.get(s);const l=function(e){let t=e.sandbox;if(!t){const{ownerDocument:n}=e;try{n&&(t=n.createElement("iframe"),t.id=`__SANDBOX__${F()}`,t.width="0",t.height="0",t.style.visibility="hidden",t.style.position="fixed",n.body.appendChild(t),t.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',e.sandbox=t)}catch(t){e.log.warn("Failed to getSandBox",t)}}return t}(n),c=l?.contentWindow;if(!c)return new Map;const d=c?.document;let u,g;a?(u=d.createElementNS($,"svg"),g=u.ownerDocument.createElementNS(u.namespaceURI,r),i.forEach(([e,t])=>{g.setAttributeNS(null,e,t)}),u.appendChild(g)):u=g=d.createElement(r),g.textContent=" ",d.body.appendChild(u);const f=c.getComputedStyle(g,t),m=new Map;for(let e=f.length,t=0;t<e;t++){const e=f.item(t);B.includes(e)||m.set(e,f.getPropertyValue(e))}return d.body.removeChild(u),o.set(s,m),m}function W(e,t,n){const o=new Map,r=[],a=new Map;if(n)for(const e of n)i(e);else for(let t=e.length,n=0;n<t;n++)i(e.item(n));for(let e=r.length,t=0;t<e;t++)a.get(r[t])?.forEach((e,t)=>o.set(t,e));function i(n){const i=e.getPropertyValue(n),s=e.getPropertyPriority(n),l=n.lastIndexOf("-"),c=l>-1?n.substring(0,l):void 0;if(c){let e=a.get(c);e||(e=new Map,a.set(c,e)),e.set(n,[i,s])}(t.get(n)!==i||s)&&(c?r.push(c):o.set(n,[i,s]))}return o}const z=["::before","::after"],O=["::-webkit-scrollbar","::-webkit-scrollbar-button","::-webkit-scrollbar-thumb","::-webkit-scrollbar-track","::-webkit-scrollbar-track-piece","::-webkit-scrollbar-corner","::-webkit-resizer"],q=new Set(["symbol"]);async function V(e,t,n,o,r){if(h(n)&&((e=>"STYLE"===e.tagName)(n)||(e=>"SCRIPT"===e.tagName)(n)))return;if(o.filter&&!o.filter(n))return;q.has(t.nodeName)||q.has(n.nodeName)?o.currentParentNodeStyle=void 0:o.currentParentNodeStyle=o.currentNodeStyle;const a=await Y(n,o,!1,r);o.isEnable("restoreScrollPosition")&&function(e,t){if(!y(e)||!y(t))return;const{scrollTop:n,scrollLeft:o}=e;if(!n&&!o)return;const{transform:r}=t.style,a=new DOMMatrix(r),{a:i,b:s,c:l,d:c}=a;a.a=1,a.b=0,a.c=0,a.d=1,a.translateSelf(-o,-n),a.a=i,a.b=s,a.c=l,a.d=c,t.style.transform=a.toString()}(e,a),t.appendChild(a)}async function H(e,t,n,o){let r=e.firstChild;h(e)&&e.shadowRoot&&(r=e.shadowRoot?.firstChild,n.shadowRoots.push(e.shadowRoot));for(let a=r;a;a=a.nextSibling)if(!b(a))if(h(a)&&S(a)&&"function"==typeof a.assignedNodes){const r=a.assignedNodes();for(let a=0;a<r.length;a++)await V(e,t,r[a],n,o)}else await V(e,t,a,n,o)}const X=/^[\w-:]+$/;async function Y(e,t,n=!1,o){const{ownerDocument:r,ownerWindow:a,fontFamilies:i,onCloneEachNode:s}=t;if(r&&(e=>3===e.nodeType)(e))return o&&/\S/.test(e.data)&&o(e.data),r.createTextNode(e.data);if(r&&a&&h(e)&&(y(e)||p(e))){const o=await function(e,t){return(e=>"CANVAS"===e.tagName)(e)?_(e,t):(e=>"IFRAME"===e.tagName)(e)?function(e,t){try{if(e?.contentDocument?.body)return Y(e.contentDocument.body,t)}catch(e){t.log.warn("Failed to clone iframe",e)}return e.cloneNode(!1)}(e,t):v(e)?function(e){const t=e.cloneNode(!1);return e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager"),t}(e):x(e)?async function(e,t){if(e.ownerDocument&&!e.currentSrc&&e.poster)return D(e.poster,e.ownerDocument);const n=e.cloneNode(!1);n.crossOrigin="anonymous",e.currentSrc&&e.currentSrc!==e.src&&(n.src=e.currentSrc);const o=n.ownerDocument;if(o){let r=!0;if(await T(n,{onError:()=>r=!1,onWarn:t.log.warn}),!r)return e.poster?D(e.poster,e.ownerDocument):n;n.currentTime=e.currentTime,await new Promise(e=>{n.addEventListener("seeked",e,{once:!0})});const a=o.createElement("canvas");a.width=e.offsetWidth,a.height=e.offsetHeight;try{const e=a.getContext("2d");e&&e.drawImage(n,0,0,a.width,a.height)}catch(o){return t.log.warn("Failed to clone video",o),e.poster?D(e.poster,e.ownerDocument):n}return _(a,t)}return n}(e,t):e.cloneNode(!1)}(e,t);if(t.isEnable("removeAbnormalAttributes")){const e=o.getAttributeNames();for(let t=e.length,n=0;n<t;n++){const t=e[n];X.test(t)||o.removeAttribute(t)}}const r=t.currentNodeStyle=function(e,t,n,o){const{ownerWindow:r,includeStyleProperties:a,currentParentNodeStyle:i}=o,s=t.style,l=r.getComputedStyle(e),c=U(e,null,o);i?.forEach((e,t)=>{c.delete(t)});const d=W(l,c,a);d.delete("transition-property"),d.delete("all"),d.delete("d"),d.delete("content"),n&&(d.delete("margin-top"),d.delete("margin-right"),d.delete("margin-bottom"),d.delete("margin-left"),d.delete("margin-block-start"),d.delete("margin-block-end"),d.delete("margin-inline-start"),d.delete("margin-inline-end"),d.set("box-sizing",["border-box",""])),"text"===d.get("background-clip")?.[0]&&t.classList.add("______background-clip--text"),g&&(d.has("font-kerning")||d.set("font-kerning",["normal",""]),"hidden"!==d.get("overflow-x")?.[0]&&"hidden"!==d.get("overflow-y")?.[0]||"ellipsis"!==d.get("text-overflow")?.[0]||e.scrollWidth!==e.clientWidth||d.set("text-overflow",["clip",""]));for(let e=s.length,t=0;t<e;t++)s.removeProperty(s.item(t));return d.forEach(([e,t],n)=>{s.setProperty(n,e,t)}),d}(e,o,n,t);n&&function(e,t){const{backgroundColor:n,width:o,height:r,style:a}=t,i=e.style;if(n&&i.setProperty("background-color",n,"important"),o&&i.setProperty("width",`${o}px`,"important"),r&&i.setProperty("height",`${r}px`,"important"),a)for(const e in a)i[e]=a[e]}(o,t);let a=!1;if(t.isEnable("copyScrollbar")){const t=[r.get("overflow-x")?.[0],r.get("overflow-y")?.[0]];a=t.includes("scroll")||(t.includes("auto")||t.includes("overlay"))&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}const l=r.get("text-transform")?.[0],c=P(r.get("font-family")?.[0]),d=c?e=>{"uppercase"===l?e=e.toUpperCase():"lowercase"===l?e=e.toLowerCase():"capitalize"===l&&(e=e[0].toUpperCase()+e.substring(1)),c.forEach(t=>{let n=i.get(t);n||i.set(t,n=new Set),e.split("").forEach(e=>n.add(e))})}:void 0;return function(e,t,n,o,r){const{ownerWindow:a,svgStyleElement:i,svgStyles:s,currentNodeStyle:l}=o;function c(n){const i=a.getComputedStyle(e,n);let c=i.getPropertyValue("content");if(!c||"none"===c)return;r?.(c),c=c.replace(/(')|(")|(counter\(.+\))/g,"");const d=[F()],u=U(e,n,o);l?.forEach((e,t)=>{u.delete(t)});const g=W(i,u,o.includeStyleProperties);g.delete("content"),g.delete("-webkit-locale"),"text"===g.get("background-clip")?.[0]&&t.classList.add("______background-clip--text");const f=[`content: '${c}';`];if(g.forEach(([e,t],n)=>{f.push(`${n}: ${e}${t?" !important":""};`)}),1===f.length)return;try{t.className=[t.className,...d].join(" ")}catch(e){return void o.log.warn("Failed to copyPseudoClass",e)}const m=f.join("\n  ");let h=s.get(m);h||(h=[],s.set(m,h)),h.push(`.${d[0]}${n}`)}i&&a&&(z.forEach(c),n&&O.forEach(c))}(e,o,a,t,d),function(e,t){((e=>"TEXTAREA"===e.tagName)(e)||(e=>"INPUT"===e.tagName)(e)||(e=>"SELECT"===e.tagName)(e))&&t.setAttribute("value",e.value)}(e,o),x(e)||await H(e,o,t,d),await(s?.(o)),o}const l=e.cloneNode(!1);return await H(e,l,t),await(s?.(l)),l}function G(e,t){const{url:n,requestType:o="text",responseType:r="text",imageDom:a}=t;let i=n;const{timeout:s,acceptOfImage:l,requests:c,fetchFn:d,fetch:{requestInit:u,bypassingCache:g,placeholderImage:h},font:p,workers:w,fontFamilies:y}=e;"image"===o&&(f||m)&&e.drawImageCount++;let b=c.get(n);if(!b){g&&g instanceof RegExp&&g.test(i)&&(i+=(/\?/.test(i)?"&":"?")+(new Date).getTime());const t=o.startsWith("font")&&p&&p.minify,m=new Set;t&&o.split(";")[1].split(",").forEach(e=>{y.has(e)&&y.get(e).forEach(e=>m.add(e))});const v=t&&m.size,x={url:i,timeout:s,responseType:v?"arrayBuffer":r,headers:"image"===o?{accept:l}:void 0,...u};b={type:o,resolve:void 0,reject:void 0,response:null},b.response=(async()=>{if(d&&"image"===o){const e=await d(n);if(e)return e}return!f&&n.startsWith("http")&&w.length?new Promise((e,t)=>{w[c.size&w.length-1].postMessage({rawUrl:n,...x}),b.resolve=e,b.reject=t}):function(e){const{url:t,timeout:n,responseType:o,...r}=e,a=new AbortController,i=n?setTimeout(()=>a.abort(),n):void 0;return fetch(t,{signal:a.signal,...r}).then(e=>{if(!e.ok)throw new Error("Failed fetch, not 2xx response",{cause:e});switch(o){case"arrayBuffer":return e.arrayBuffer();case"dataUrl":return e.blob().then(k);default:return e.text()}}).finally(()=>clearTimeout(i))}(x)})().catch(t=>{if(c.delete(n),"image"===o&&h)return e.log.warn("Failed to fetch image base64, trying to use placeholder image",i),"string"==typeof h?h:h(a);throw t}),c.set(n,b)}return b.response}async function J(e,t,n,o){if(!K(e))return e;for(const[r,a]of function(e,t){const n=[];return e.replace(Q,(e,o,r)=>(n.push([r,A(r,t)]),e)),n.filter(([e])=>!C(e))}(e,t))try{const t=await G(n,{url:a,requestType:o?"image":"text",responseType:"dataUrl"});e=e.replace(Z(r),`$1${t}$3`)}catch(e){n.log.warn("Failed to fetch css data url",r,e)}return e}function K(e){return/url\((['"]?)([^'"]+?)\1\)/.test(e)}const Q=/url\((['"]?)([^'"]+?)\1\)/g;function Z(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}const ee=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function te(e,t){const{tasks:n}=t;h(e)&&((v(e)||w(e))&&n.push(...function(e,t){if(v(e)){const n=e.currentSrc||e.src;if(!C(n))return[G(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(t=>{t&&(e.srcset="",e.dataset.originalSrc=n,e.src=t||"")})];(f||m)&&t.drawImageCount++}else if(p(e)&&!C(e.href.baseVal)){const n=e.href.baseVal;return[G(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(t=>{t&&(e.dataset.originalSrc=n,e.href.baseVal=t||"")})]}return[]}(e,t)),"use"===e.tagName&&n.push(...function(e,t){const{ownerDocument:n,svgDefsElement:o}=t,r=e.getAttribute("href")??e.getAttribute("xlink:href");if(!r)return[];const[a,i]=r.split("#");if(i){const r=`#${i}`,s=t.shadowRoots.reduce((e,t)=>e??t.querySelector(`svg ${r}`),n?.querySelector(`svg ${r}`));if(a&&e.setAttribute("href",r),o?.querySelector(r))return[];if(s)return o?.appendChild(s.cloneNode(!0)),[];if(a)return[G(t,{url:a,responseType:"text"}).then(e=>{o?.insertAdjacentHTML("beforeend",e)})]}return[]}(e,t))),y(e)&&n.push(...function(e,t){return ee.map(n=>{const o=e.getPropertyValue(n);return o&&"none"!==o?((f||m)&&t.drawImageCount++,J(o,null,t,!0).then(t=>{t&&o!==t&&e.setProperty(n,t,e.getPropertyPriority(n))})):null}).filter(Boolean)}(e.style,t)),e.childNodes.forEach(e=>{te(e,t)})}const ne=/(\/\*[\s\S]*?\*\/)/g,oe=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi,re=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ae=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ie(e,t){const{font:n}=t,o=n?n?.preferredFormat:void 0;return o?e.replace(ae,e=>{for(;;){const[t,,n]=re.exec(e)||[];if(!n)return"";if(n===o)return`src: ${t};`}}):e}async function se(e,t){const n=await L(e,t);if(h(n.node)&&p(n.node))return n.node;const{ownerDocument:o,log:r,tasks:a,svgStyleElement:i,svgDefsElement:s,svgStyles:l,font:c,progress:d,autoDestruct:u,onCloneNode:g,onEmbedNode:f,onCreateForeignObjectSvg:m}=n;r.time("clone node");const w=await Y(n.node,n,!0);if(i&&o){let e="";l.forEach((t,n)=>{e+=`${t.join(",\n")} {\n  ${n}\n}\n`}),i.appendChild(o.createTextNode(e))}r.timeEnd("clone node"),await(g?.(w)),!1!==c&&h(w)&&(r.time("embed web font"),await async function(e,t){const{ownerDocument:n,svgStyleElement:o,fontFamilies:r,fontCssTexts:a,tasks:i,font:s}=t;if(n&&o&&r.size)if(s&&s.cssText){const e=ie(s.cssText,t);o.appendChild(n.createTextNode(`${e}\n`))}else{const e=Array.from(n.styleSheets).filter(e=>{try{return"cssRules"in e&&Boolean(e.cssRules.length)}catch(n){return t.log.warn(`Error while reading CSS rules from ${e.href}`,n),!1}});await Promise.all(e.flatMap(e=>Array.from(e.cssRules).map(async(n,o)=>{if("CSSImportRule"===n.constructor.name){let r=o+1;const a=n.href;let i="";try{i=await G(t,{url:a,requestType:"text",responseType:"text"})}catch(e){t.log.warn(`Error fetch remote css import from ${a}`,e)}const s=i.replace(Q,(e,t,n)=>e.replace(n,A(n,a)));for(const n of function(e){if(null==e)return[];const t=[];let n=e.replace(ne,"");for(;;){const e=oe.exec(n);if(!e)break;t.push(e[0])}n=n.replace(oe,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,r=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=o.exec(n);if(e)r.lastIndex=o.lastIndex;else{if(e=r.exec(n),!e)break;o.lastIndex=r.lastIndex}t.push(e[0])}return t}(s))try{e.insertRule(n,n.startsWith("@import")?r+=1:e.cssRules.length)}catch(e){t.log.warn("Error inserting rule from remote css import",{rule:n,error:e})}}}))),e.flatMap(e=>Array.from(e.cssRules)).filter(e=>"CSSFontFaceRule"===e.constructor.name&&K(e.style.getPropertyValue("src"))&&P(e.style.getPropertyValue("font-family"))?.some(e=>r.has(e))).forEach(e=>{const r=e,s=a.get(r.cssText);s?o.appendChild(n.createTextNode(`${s}\n`)):i.push(J(r.cssText,r.parentStyleSheet?r.parentStyleSheet.href:null,t).then(e=>{e=ie(e,t),a.set(r.cssText,e),o.appendChild(n.createTextNode(`${e}\n`))}))})}}(0,n),r.timeEnd("embed web font")),r.time("embed node"),te(w,n);const y=a.length;let b=0;d?.(b,y),await Promise.all([...Array.from({length:4})].map(async()=>{for(;;){const e=a.pop();if(!e)break;try{await e}catch(e){n.log.warn("Failed to run task",e)}d?.(++b,y)}})),r.timeEnd("embed node"),await(f?.(w));const v=function(e,t){const{width:n,height:o}=t,r=function(e,t,n){const o=N(n).createElementNS($,"svg");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"viewBox",`0 0 ${e} ${t}`),o}(n,o,e.ownerDocument),a=r.ownerDocument.createElementNS(r.namespaceURI,"foreignObject");return a.setAttributeNS(null,"x","0%"),a.setAttributeNS(null,"y","0%"),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.append(e),r.appendChild(a),r}(w,n);return s&&v.insertBefore(s,v.children[0]),i&&v.insertBefore(i,v.children[0]),u&&function(e){if(e.ownerDocument=void 0,e.ownerWindow=void 0,e.svgStyleElement=void 0,e.svgDefsElement=void 0,e.svgStyles.clear(),e.defaultComputedStyles.clear(),e.sandbox){try{e.sandbox.remove()}catch(t){e.log.warn("Failed to destroyContext",t)}e.sandbox=void 0}e.workers=[],e.fontFamilies.clear(),e.fontCssTexts.clear(),e.requests.clear(),e.tasks=[],e.shadowRoots=[]}(n),await(m?.(v)),v}async function le(e,t){const n=await L(e,t),o=await se(n),r=function(e,t){let n=(new XMLSerializer).serializeToString(e);return t&&(n=n.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`}(o,n.isEnable("removeControlCharacter"));n.autoDestruct||(n.svgStyleElement=R(n.ownerDocument),n.svgDefsElement=n.ownerDocument?.createElementNS($,"defs"),n.svgStyles.clear());const a=D(r,o.ownerDocument);return await async function(e,t){const{log:n,timeout:o,drawImageCount:r,drawImageInterval:a}=t;n.time("image to canvas");const i=await T(e,{timeout:o,onWarn:t.log.warn}),{canvas:s,context2d:l}=function(e,t){const{width:n,height:o,scale:r,backgroundColor:a,maximumCanvasSize:i}=t,s=e.createElement("canvas");s.width=Math.floor(n*r),s.height=Math.floor(o*r),s.style.width=`${n}px`,s.style.height=`${o}px`,i&&(s.width>i||s.height>i)&&(s.width>i&&s.height>i?s.width>s.height?(s.height*=i/s.width,s.width=i):(s.width*=i/s.height,s.height=i):s.width>i?(s.height*=i/s.width,s.width=i):(s.width*=i/s.height,s.height=i));const l=s.getContext("2d");return l&&a&&(l.fillStyle=a,l.fillRect(0,0,s.width,s.height)),{canvas:s,context2d:l}}(e.ownerDocument,t),c=()=>{try{l?.drawImage(i,0,0,s.width,s.height)}catch(e){t.log.warn("Failed to drawImage",e)}};if(c(),t.isEnable("fixSvgXmlDecode"))for(let e=0;e<r;e++)await new Promise(t=>{setTimeout(()=>{l?.clearRect(0,0,s.width,s.height),c(),t()},e+a)});return t.drawImageCount=0,n.timeEnd("image to canvas"),s}(a,n)}!function(){if(window.__visualBrowserPickerInjected)return;window.__visualBrowserPickerInjected=!0;let e=!1,t=null,n=!1;const o=document.createElement("div");o.id="visual-browser-injected-overlay",o.style.cssText="\n        position: fixed;\n        pointer-events: none;\n        background: rgba(59, 130, 246, 0.1);\n        border: 1px solid rgba(59, 130, 246, 0.5);\n        z-index: 2147483646;\n        display: none;\n        transition: all 0.05s ease-out;\n    ";const r=document.createElement("span");r.style.cssText="\n        position: absolute;\n        top: -24px;\n        left: 0;\n        background: #3b82f6;\n        color: white;\n        padding: 2px 6px;\n        font-family: Consolas, monospace;\n        font-size: 12px;\n        border-radius: 2px;\n        pointer-events: none;\n        white-space: nowrap;\n    ",o.appendChild(r),function e(){document.body?document.body.appendChild(o):document.addEventListener("DOMContentLoaded",e)}(),window.addEventListener("message",r=>{r.data&&"togglePicker"===r.data.command&&(e=r.data.enabled,e&&(n=!1),e?document.body.style.cursor="crosshair":(o.style.display="none",t=null,document.body.style.cursor="")),r.data&&"toggleSnipper"===r.data.command&&(n=r.data.enabled,n&&(e=!1),n?(document.body.style.cursor="crosshair",i||(i=document.createElement("div"),i.id="visual-browser-snipper-overlay",i.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            z-index: 2147483647;\n            background: rgba(0, 0, 0, 0.3);\n            cursor: crosshair;\n        ",s=document.createElement("div"),s.style.cssText="\n            position: absolute;\n            border: 2px solid #3b82f6;\n            background: rgba(59, 130, 246, 0.1);\n            display: none;\n            pointer-events: none;\n        ",i.appendChild(s),document.body.appendChild(i),i.addEventListener("mousedown",m),i.addEventListener("mousemove",h),i.addEventListener("mouseup",p))):(document.body.style.cursor="",f()))});let i=null,s=null,l=0,u=0,g=!1;function f(){i&&(i.remove(),i=null,s=null)}function m(e){g=!0,l=e.clientX,u=e.clientY,s&&(s.style.display="block",s.style.left=l+"px",s.style.top=u+"px",s.style.width="0px",s.style.height="0px")}function h(e){if(!g||!s)return;const t=e.clientX,n=e.clientY,o=Math.abs(t-l),r=Math.abs(n-u),a=Math.min(t,l),i=Math.min(n,u);s.style.width=o+"px",s.style.height=r+"px",s.style.left=a+"px",s.style.top=i+"px"}function p(e){if(g=!1,!s||!i)return;const t=s.getBoundingClientRect();t.width>5&&t.height>5?(t.left,window.scrollX,t.top,window.scrollY,i.style.display="none",o&&(o.style.display="none"),requestAnimationFrame(async()=>{try{const e=await async function(e,t){return async function(e,t){const n=await L(e,t),{log:o,quality:r,type:i,dpi:s}=n,l=await le(n);o.time("canvas to data url");let u=l.toDataURL(i,r);if(["image/png","image/jpeg"].includes(i)&&s&&c&&d){const[e,t]=u.split(",");let n=0,o=!1;if("image/png"===i){const e=function(e){let t=e.indexOf("AAlwSFlz");return-1===t&&(t=e.indexOf("AAAJcEhZ")),-1===t&&(t=e.indexOf("AAAACXBI")),t}(t);e>=0?(n=4*Math.ceil((e+28)/3),o=!0):n=44}else"image/jpeg"===i&&(n=24);const r=t.substring(0,n),l=t.substring(n),c=window.atob(r),d=new Uint8Array(c.length);for(let e=0;e<d.length;e++)d[e]=c.charCodeAt(e);const g="image/png"===i?a(d,s,o):function(e,t){return e[13]=1,e[14]=t>>8,e[15]=255&t,e[16]=t>>8,e[17]=255&t,e}(d,s);u=[e,",",window.btoa(String.fromCharCode(...g)),l].join("")}return o.timeEnd("canvas to data url"),u}(await L(e,{...t,type:"image/png"}))}(document.body,{width:window.innerWidth,height:window.innerHeight,scale:1,filter:e=>{const t=e;return"none"!==t.style?.display&&"hidden"!==t.style?.visibility&&"visual-browser-injected-overlay"!==t.id&&"visual-browser-snipper-overlay"!==t.id&&"react-toolbar-root"!==t.id&&"visual-browser-devtools-overlay"!==t.id}}),n=new Image;n.onload=()=>{const e=document.createElement("canvas"),o=e.getContext("2d");if(!o)return;e.width=t.width,e.height=t.height;const r=t.left,a=t.top;o.drawImage(n,r,a,t.width,t.height,0,0,t.width,t.height);const i=e.toDataURL("image/jpeg",.8);window.parent.postMessage({command:"screenshotCaptured",data:i},"*")},n.src=e}catch(e){console.error("[Screenshot Debug] Capture failed:",e)}}),f(),window.parent.postMessage({command:"toggleSnipper",enabled:!1},"*")):(f(),window.parent.postMessage({command:"toggleSnipper",enabled:!1},"*"))}let w=null;document.addEventListener("mousemove",n=>{e&&(w||(w=requestAnimationFrame(()=>{w=null;const e=n.target;if(e!==o&&e!==r&&t!==e){t=e;const n=e.getBoundingClientRect();o.style.display="block",o.style.transform=`translate(${n.left}px, ${n.top}px)`,o.style.width=n.width+"px",o.style.height=n.height+"px",o.style.top="0",o.style.left="0";const a=e.id?"#"+e.id:"",i=e.tagName?e.tagName.toLowerCase():"";r.textContent=i+a+" "+Math.round(n.width)+"x"+Math.round(n.height)}})))},!0),document.addEventListener("click",t=>{if(!e)return;t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();const n=function(e){const t=e.getBoundingClientRect(),n=function(e){if(!e)return"";const t=[];let n=e;for(;n&&n.parentNode&&"HTML"!==n.tagName;){let e=n.tagName.toLowerCase();if(n.id){e+="#"+n.id,t.unshift(e);break}n.className&&"string"==typeof n.className&&n.className.trim()&&(e+="."+n.className.trim().split(/\s+/).join(".")),t.unshift(e),n=n.parentNode}return t.join(" > ")}(e),o=function(e){const t=window.getComputedStyle(e),n=t.display.includes("flex"),o=t.display.includes("grid");let r=`display=${t.display}`;return(n||o)&&(r+=`, gap=${t.gap}`,r+=`, justify=${t.justifyContent}`,r+=`, align=${t.alignItems}`,n&&(r+=`, direction=${t.flexDirection}`)),{color:t.color,background:t.backgroundColor,fontSize:t.fontSize,fontFamily:t.fontFamily,font:`${t.fontSize} ${t.fontFamily}`,model:`m:${t.margin}, p:${t.padding}, border:${t.borderWidth}`,layout:r,visibility:`z-index=${t.zIndex}, opacity=${t.opacity}, visibility=${t.visibility}`}}(e),r=function(e){if(!e.hasAttributes())return"";const t=[];for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n];"class"!==o.name&&"style"!==o.name&&"id"!==o.name&&t.push(`${o.name}="${o.value}"`)}return t.length>0?"Attributes: "+t.join(" "):""}(e),a=e.outerHTML.substring(0,500).replace(/\s+/g," ").trim();return`\n**Picked Element Details:**\n\n- **DOM Path:** \`${n}\`\n- **Position:** \`top=${Math.round(t.top)}px\`, \`left=${Math.round(t.left)}px\`, \`width=${Math.round(t.width)}px\`, \`height=${Math.round(t.height)}px\`\n\n**Visual Properties:**\n- **Styles:** \`color=${o.color}\`, \`bg=${o.background}\`, \`font=${o.font}\`\n- **Layout:** \`display=${o.layout.split("=")[1]||o.layout}\`, \`${o.model}\`\n- **Visibility:** \`${o.visibility}\`\n${r?"- **Attributes:** `"+r+"`":""}\n\n**Code:**\n\`\`\`html\n${a}\n\`\`\`\n`.trim()}(t.target);window.parent.postMessage({command:"elementPicked",text:n},"*")},!0)}()})();